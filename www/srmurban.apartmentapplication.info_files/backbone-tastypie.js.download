!function(t){Backbone.oldSync=Backbone.sync,Backbone.sync=function(t,e,r){if("create"===t){var c=new $.Deferred;return c.done(r.success),r.success=function(t,e,o){if(201!==o.status||t)return c.resolveWith(r.context||r,[t,e,o]);var n=o.getResponseHeader("Location");return $.ajax({url:n,success:c.resolve,error:c.reject})},c.fail(r.error),r.error=function(t,e,o){c.rejectWith(r.context||r,[t,e,o])},c.request=Backbone.oldSync(t,e,r),c}return Backbone.oldSync(t,e,r)},Backbone.Model.prototype.idAttribute="resource_uri",Backbone.Model.prototype.url=function(){var t=this.id;return t||(t=(t=this.urlRoot)||this.collection&&(_.isFunction(this.collection.url)?this.collection.url():this.collection.url))&&this.has("id")&&(t=o(t)+this.get("id")),(t=t&&o(t))||null},Backbone.Model.prototype.parse=function(t){return t&&t.objects&&(_.isArray(t.objects)?t.objects[0]:t.objects)||t},Backbone.Collection.prototype.parse=function(t){return t&&t.meta&&(this.meta=t.meta),t&&t.objects},Backbone.Collection.prototype.url=function(t){var e=this.urlRoot||t&&t.length&&t[0].urlRoot;(e=e&&o(e),t&&t.length)&&(e+="set/"+_.map(t,function(t){var e=_.compact(t.id.split("/"));return e[e.length-1]}).join(";")+"/");return e||null};var o=function(t){return t+(0<t.length&&"/"===t.charAt(t.length-1)?"":"/")}}();